import{e as V,f as $,g,_ as E,h as y,m,r as k,o as l,c,b as x,a as e,i as _,v as R,j as w,k as S,F as b,l as P,t as h,n as T,p as A}from"./index-4sHf3l6z.js";import{u as L}from"./userPostsStore-UeiCrmQM.js";import{u as U}from"./userUsersStore-RZEYF_5w.js";import{s as f,e as v}from"./swalToasts-aNV-8xkx.js";import{U as j}from"./UserNavbar-5uJOKQ3p.js";import{U as N}from"./UserDashboard--UbgQ6Is.js";import"./user_default-gs4whxCm.js";var I={VITE_APP_URL:"https://two024-node-week4.onrender.com",BASE_URL:"/2024-node-week4_frontend/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const M=V.useLoading({}),{VITE_APP_URL:B}=I,O=$("userCommentsStore",{state:()=>({}),actions:{async createComment(s,t){const n=M.show(),a=`${B}/posts/${s}/comment`;try{const r=await g.post(a,{comment:t});f(r.data.message)}catch(r){v(r.response.data.message)}finally{n.hide()}}}});var F={VITE_APP_URL:"https://two024-node-week4.onrender.com",BASE_URL:"/2024-node-week4_frontend/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const C=V.useLoading({}),{VITE_APP_URL:D}=F,H=$("userLikesStore",{state:()=>({}),actions:{async likePost(s){const t=C.show(),n=`${D}/posts/${s}/like`;try{const a=await g.post(n);f(a.data.message)}catch(a){v(a.response.data.message)}finally{t.hide()}},async unlikePost(s){const t=C.show(),n=`${D}/posts/${s}/unlike`;try{const a=await g.delete(n);f(a.data.message)}catch(a){v(a.response.data.message)}finally{t.hide()}}}}),z={components:{UserNavbar:j,UserDashboard:N},data(){return{timeSort:"",keyword:"",comment:"",isLike:!1}},mounted(){this.getPosts(),this.getProfile()},computed:{...y(L,["postsList"]),...y(U,["profile"])},methods:{...m(L,["getPosts"]),...m(U,["getProfile"]),...m(O,["createComment"]),...m(H,["likePost","unlikePost"]),handleSearchPosts(s){this.getPosts("asc",s)},handleLikePost(s){this.likePost(s),this.isLike=!this.isLike,this.getPosts()},handleCreateComment(s,t){this.createComment(s,t),this.getPosts()},formattedTime(s){const t=new Date(s),n=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),p=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${n}-${a}-${r} ${d}:${p}:${u}`}}},Y={class:"container py-12"},q={class:"row"},G={class:"col-8"},J={class:"row mb-4"},K={class:"col-4"},Q=e("option",{value:"",selected:""},"請選擇順序",-1),W=e("option",{value:"asc"},"從新到舊",-1),X=e("option",{value:"desc"},"從舊到新",-1),Z=[Q,W,X],ee={class:"col-8"},te={class:"input-group"},se=e("i",{class:"bi bi-search text-white fs-4"},null,-1),oe=[se],re={key:0,class:"row"},ae=A('<div class="col"><div class="bg-white rounded border border-2 border-black" style="border-bottom:4px solid black !important;"><div class="d-flex align-items-center gap-2 border-bottom border-2 border-black p-4 w-100" style="height:52px;"><div class="rounded border border-black border-1 bg-danger" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-warning" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-success" style="width:10px;height:10px;"></div></div><div class="text-center py-8" style="height:80px;"><p class="text-gray">目前尚無動態，新增一則貼文吧！</p></div></div></div>',1),ie=[ae],ne={key:1,class:"row gy-6"},de={class:"bg-white rounded border border-2 border-black p-6",style:{"border-bottom":"4px solid black !important"}},le={class:"d-flex gap-2 mb-4"},ce={class:"rounded-circle overflow-hidden",style:{width:"45px",height:"45px"}},he=["src","alt"],me={class:"d-flex flex-column justify-content-between text-start"},pe={class:"noto-sans-tc text-primary fw-bold"},ue={class:"baloo-da-2 text-gray"},_e={class:"noto-sans-tc mb-4"},be=["src","alt"],ge={class:"d-flex justify-content-end align-items-end gap-2 mb-5"},fe=["onClick"],ve={class:"baloo-da-2 fw-bold"},ye={class:"d-flex align-items-center gap-2 mb-4"},ke={class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},xe=["src","alt"],we={class:"input-group"},Se=["onClick"],Pe={class:"row px-4 gy-4"},Le={class:"d-flex align-items-center gap-2 mb-1"},Ue={class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},Ce=["src","alt"],De={class:"d-flex flex-column justify-content-between text-start"},Ve={class:"noto-sans-tc text-primary fw-bold"},$e={class:"baloo-da-2 text-gray"},Ee={class:"ms-12 mb-0"},Re={class:"col-4"};function Te(s,t,n,a,r,d){const p=k("UserNavbar"),u=k("UserDashboard");return l(),c(b,null,[x(p),e("div",Y,[e("div",q,[e("div",G,[e("div",J,[e("div",K,[_(e("select",{onInput:t[0]||(t[0]=o=>s.getPosts(r.timeSort)),"onUpdate:modelValue":t[1]||(t[1]=o=>r.timeSort=o),class:"form-select rounded-0 border-2 border-black py-3 ps-4 pe-10","aria-label":"posts-select"},Z,544),[[R,r.timeSort]])]),e("div",ee,[e("div",te,[_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.keyword=o),type:"text",class:"form-control rounded-0 border-2 border-black py-3 px-4",placeholder:"搜尋貼文","aria-label":"搜尋貼文","aria-describedby":"搜尋貼文"},null,512),[[w,r.keyword]]),e("button",{onClick:t[3]||(t[3]=o=>d.handleSearchPosts(r.keyword)),class:"btn btn-primary rounded-0 px-4",type:"button"},oe)])])]),s.postsList.length?S("",!0):(l(),c("div",re,ie)),s.postsList.length?(l(),c("div",ne,[(l(!0),c(b,null,P(s.postsList,o=>(l(),c("div",{key:o._id,class:"col-12"},[e("div",de,[e("div",le,[e("div",ce,[e("img",{src:o.user.photo,alt:`user-photo-${o.user.name}`,class:"object-fit-cover img-fluid",style:{height:"45px"}},null,8,he)]),e("div",me,[e("span",pe,h(o.user.name),1),e("small",ue,h(d.formattedTime(o.createdAt)),1)])]),e("p",_e,h(o.content),1),e("img",{src:o.image,alt:`photo-${o.image}`,class:"object-fit-cover img-fluid rounded border border-2 border-black mb-5"},null,8,be),e("div",ge,[e("button",{onClick:i=>d.handleLikePost(o._id),type:"button",class:"btn p-0"},[e("i",{class:T([r.isLike?"bi bi-hand-thumbs-up-fill":"bi bi-hand-thumbs-up","fs-5 text-primary"])},null,2)],8,fe),e("span",ve,h(o.likes.length),1)]),e("div",ye,[e("div",ke,[e("img",{src:s.profile.photo,alt:`user-photo-${s.profile.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,xe)]),e("div",we,[_(e("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>r.comment=i),type:"text",class:"form-control rounded-0 border-2 border-black py-2 px-4",placeholder:"留言...","aria-label":"留言","aria-describedby":"留言"},null,512),[[w,r.comment]]),e("button",{onClick:i=>d.handleCreateComment(o._id,r.comment),class:"btn btn-primary rounded-0 px-4 text-white",type:"button",style:{width:"25%"}},"留言",8,Se)])]),e("div",Pe,[(l(!0),c(b,null,P(o.comments,i=>(l(),c("div",{key:i._id,class:"col-12 rounded p-4",style:{"background-color":"rgb(239 236 231 / 50%)"}},[e("div",Le,[e("div",Ue,[e("img",{src:i.user.photo,alt:`user-photo-${i.user.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,Ce)]),e("div",De,[e("span",Ve,h(i.user.name),1),e("small",$e,h(d.formattedTime(i.createdAt)),1)])]),e("p",Ee,h(i.comment),1)]))),128))])])]))),128))])):S("",!0)]),e("div",Re,[x(u)])])])],64)}const Fe=E(z,[["render",Te]]);export{Fe as default};
