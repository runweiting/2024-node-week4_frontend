import{_ as C,e as _,m as h,r as g,o as i,c as l,b as f,a as e,f as b,v as P,g as v,h as c,F as m,i as p,t as d,n as S,j as U}from"./index-oNhqvqyD.js";import{p as y}from"./postsStore-Unf0Vpia.js";import{u as x}from"./userUsersStore-Md3XKH52.js";import{u as j,a as L}from"./userLikesStore-Uy7D4779.js";import{U as T}from"./UserNavbar-qD5bruDc.js";import{U as D}from"./UserDashboard-xE2MAAEW.js";import{f as A}from"./formatCreatedAt-CTMo6T3e.js";import"./swalToasts-kg3gisn3.js";import"./user_default-gs4whxCm.js";const N={components:{UserNavbar:T,UserDashboard:D},data(){return{timeSort:"",keyword:"",comment:""}},mounted(){this.getPosts(),this.getProfile()},computed:{..._(y,["postsList"]),..._(x,["profile"])},methods:{...h(y,["getPosts"]),...h(x,["getProfile"]),...h(j,["createComment","deleteComment"]),...h(L,["handleLikePost","isLiked","likePost","unlikePost"]),handleSearchPosts(s){this.getPosts("asc",s)},handleCreateComment(s,o){this.createComment(s,o),this.comment="",this.resetTextareaHeight(),this.getPosts()},handleDeleteComment(s){this.deleteComment(s).then(()=>this.getPosts())},adjustTextareaHeight(s){const o=s.target;o&&(o.style.height=`${o.scrollHeight}px`)},resetTextareaHeight(){const s=this.$refs.commentTextarea;s&&(s[0].style.height="1rem")},formatCreatedAt:A}},V={class:"container py-12"},H={class:"row"},B={class:"col-8"},z={class:"row mb-4"},F={class:"col-4"},I=e("option",{value:"",selected:""},"請選擇順序",-1),M=e("option",{value:"asc"},"從新到舊",-1),E=e("option",{value:"desc"},"從舊到新",-1),W=[I,M,E],q={class:"col-8"},G={class:"input-group"},J=e("i",{class:"bi bi-search text-white fs-4"},null,-1),K=[J],O={key:0,class:"row"},Q=U('<div class="col"><div class="bg-white rounded border border-2 border-black" style="border-bottom:4px solid black !important;"><div class="d-flex align-items-center gap-2 border-bottom border-2 border-black p-4 w-100" style="height:52px;"><div class="rounded border border-black border-1 bg-danger" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-warning" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-success" style="width:10px;height:10px;"></div></div><div class="text-center py-8" style="height:80px;"><p class="text-gray">目前尚無動態，新增一則貼文吧！</p></div></div></div>',1),R=[Q],X={key:1,class:"row gy-6"},Y={class:"bg-white rounded border border-2 border-black p-6",style:{"border-bottom":"4px solid black !important"}},Z={key:0,class:"d-flex gap-2 mb-4"},$={class:"rounded-circle overflow-hidden",style:{width:"45px",height:"45px"}},ee=["src","alt"],te={class:"d-flex flex-column justify-content-between text-start"},se={class:"noto-sans-tc text-primary fw-bold"},oe={class:"baloo-da-2 text-gray"},re={class:"noto-sans-tc mb-4"},ie=["src","alt"],le={class:"d-flex gap-2 mb-5"},de={class:"d-flex align-items-center mb-5"},ae={key:0,class:"d-flex align-items-center gap-2"},ne=e("div",{class:"rounded-circle overflow-hidden bg-primary position-relative",style:{width:"24px",height:"24px"}},[e("i",{class:"bi bi-hand-thumbs-up-fill text-white position-absolute top-50 start-50 translate-middle"})],-1),ce={class:"noto-sans-tc"},he={class:"ms-auto"},me={class:"d-flex align-items-center gap-2"},be=["onClick"],pe={class:"baloo-da-2 fw-bold"},ue={class:"d-flex align-items-start gap-2 mb-4 w-100"},_e={key:0,class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},ge=["src","alt"],fe=["onClick"],ve={class:"row px-4 gy-4"},ye={class:"d-flex align-items-center gap-2 mb-1"},xe={class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},ke=["src","alt"],we={class:"d-flex flex-column justify-content-between text-start"},Ce={class:"noto-sans-tc text-primary fw-bold"},Pe={class:"baloo-da-2 text-gray"},Se={class:"d-flex justify-content-between align-items-center"},Ue={class:"ms-12 mb-1",style:{width:"85%"}},je={class:"mt-auto"},Le=["onClick"],Te=e("i",{class:"bi bi-trash3 text-primary"},null,-1),De=[Te],Ae={class:"col-4"};function Ne(s,o,Ve,He,a,n){const k=g("UserNavbar"),w=g("UserDashboard");return i(),l(m,null,[f(k),e("div",V,[e("div",H,[e("div",B,[e("div",z,[e("div",F,[b(e("select",{onInput:o[0]||(o[0]=t=>s.getPosts(a.timeSort)),"onUpdate:modelValue":o[1]||(o[1]=t=>a.timeSort=t),class:"form-select rounded-0 border-2 border-black py-3 ps-4 pe-10","aria-label":"posts-select"},W,544),[[P,a.timeSort]])]),e("div",q,[e("div",G,[b(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>a.keyword=t),type:"text",class:"form-control rounded-0 border-2 border-black py-3 px-4",placeholder:"搜尋貼文","aria-label":"搜尋貼文","aria-describedby":"搜尋貼文"},null,512),[[v,a.keyword]]),e("button",{onClick:o[3]||(o[3]=t=>n.handleSearchPosts(a.keyword)),class:"btn btn-primary rounded-0 px-4",type:"button"},K)])])]),s.postsList.length?c("",!0):(i(),l("div",O,R)),s.postsList.length?(i(),l("div",X,[(i(!0),l(m,null,p(s.postsList,t=>(i(),l("div",{key:t.id,class:"col-12"},[e("div",Y,[t.user?(i(),l("div",Z,[e("div",$,[e("img",{src:t.user.photo,alt:`user-photo-${t.user.name}`,class:"object-fit-cover img-fluid",style:{height:"45px"}},null,8,ee)]),e("div",te,[e("span",se,d(t.user.name),1),e("small",oe,d(n.formatCreatedAt(t.createdAt).formattedDateAndTime),1)])])):c("",!0),e("p",re,d(t.content),1),e("img",{src:t.image,alt:`photo-${t.image}`,class:"object-fit-cover img-fluid rounded border border-2 border-black mb-2"},null,8,ie),e("div",le,[(i(!0),l(m,null,p(t.tags,(r,u)=>(i(),l("span",{key:u,class:"badge rounded-pill bg-secondary text-black noto-sans-tc border border-2 border-black"},d(r),1))),128))]),e("div",de,[t.likes.length?(i(),l("div",ae,[ne,e("small",ce,d(t.likes[0].user.name)+" 和其他 "+d(t.likes.length-1)+"人按讚",1)])):c("",!0),e("div",he,[e("div",me,[e("button",{onClick:r=>s.handleLikePost(t._id,s.profile._id),type:"button",class:"btn p-0"},[e("i",{class:S([s.isLiked(t,s.profile._id)?"bi bi-hand-thumbs-up-fill":"bi bi-hand-thumbs-up","fs-5 text-primary"])},null,2)],8,be),e("span",pe,d(t.likes.length),1)])])]),e("div",ue,[s.profile._id?(i(),l("div",_e,[e("img",{src:s.profile.photo,alt:`user-photo-${s.profile.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,ge)])):c("",!0),b(e("textarea",{ref_for:!0,ref:"commentTextarea","onUpdate:modelValue":o[4]||(o[4]=r=>a.comment=r),class:"form-control rounded border-2 border-black py-2 px-4",placeholder:"留言...","aria-label":"留言","aria-describedby":"留言",rows:"1",style:{flex:"3",overflow:"hidden",resize:"none"},onInput:o[5]||(o[5]=(...r)=>n.adjustTextareaHeight&&n.adjustTextareaHeight(...r))},null,544),[[v,a.comment]]),e("button",{onClick:r=>n.handleCreateComment(t._id,a.comment),class:"btn btn-warning rounded border-2 border-primary px-4 py-2",type:"button",style:{flex:"1"}},"留言",8,fe)]),e("div",ve,[(i(!0),l(m,null,p(t.comments,r=>(i(),l("div",{key:r._id,class:"col-12 rounded p-4",style:{"background-color":"rgb(239 236 231 / 50%)"}},[e("div",ye,[e("div",xe,[e("img",{src:r.user.photo,alt:`user-photo-${r.user.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,ke)]),e("div",we,[e("span",Ce,d(r.user.name),1),e("small",Pe,d(n.formatCreatedAt(r.createdAt).formattedDateAndTime),1)])]),e("div",Se,[e("p",Ue,d(r.comment),1),e("div",je,[e("button",{onClick:u=>n.handleDeleteComment(r._id),type:"button",class:"btn p-0"},De,8,Le)])])]))),128))])])]))),128))])):c("",!0)]),e("div",Ae,[f(w)])])])],64)}const Je=C(N,[["render",Ne]]);export{Je as default};
