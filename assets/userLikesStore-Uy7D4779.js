import{l as p,p as f,q as n}from"./index-oNhqvqyD.js";import{s as i,e as r}from"./swalToasts-kg3gisn3.js";import{p as _}from"./postsStore-Unf0Vpia.js";var g={VITE_APP_URL:"https://two024-node-week4.onrender.com",BASE_URL:"/2024-node-week4_frontend/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const l=p.useLoading({}),{VITE_LOCALHOST:d}=g,y=f("userCommentsStore",{state:()=>({}),actions:{async createComment(s,o){const t=l.show(),e=`${d}/posts/${s}/comment`;try{const a=await n.post(e,{comment:o});i(a.data.message)}catch(a){r(a.response.data.message)}finally{t.hide()}},async deleteComment(s){const o=l.show(),t=`${d}/posts/${s}/uncomment`;try{const e=await n.delete(t);i(e.data.message)}catch(e){r(e.response.data.message)}finally{o.hide()}}}});var h={VITE_APP_URL:"https://two024-node-week4.onrender.com",BASE_URL:"/2024-node-week4_frontend/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const m=p.useLoading({}),{VITE_LOCALHOST:u}=h,P=f("userLikesStore",{state:()=>({}),actions:{async handleLikePost(s,o){const t=_(),a=await t.getAllPosts.find(c=>c._id===s);console.log("targetPost",a);try{this.isLiked(a,o)?await this.unlikePost(s):await this.likePost(s),await t.getPosts()}catch(c){r(c.response)}},isLiked(s,o){return!s||!Array.isArray(s.likes)?!1:s.likes.some(t=>t.user._id===o)},async likePost(s){const o=m.show(),t=`${u}/posts/${s}/like`;try{const e=await n.post(t);i(e.data.message)}catch(e){console.log(e),r(e.response.data.message)}finally{o.hide()}},async unlikePost(s){const o=m.show(),t=`${u}/posts/${s}/unlike`;try{const e=await n.delete(t);i(e.data.message)}catch(e){console.log(e),r(e.response.data.message)}finally{o.hide()}}}});export{P as a,y as u};
