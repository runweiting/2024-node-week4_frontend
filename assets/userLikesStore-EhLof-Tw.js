import{s as w,u as P,x as i}from"./index-9bM_Bw9A.js";import{s as c,e as r}from"./swalToasts-V6HhvdSj.js";import{p as _}from"./postsStore--xiGuWll.js";var h={VITE_APP_URL:"https://two024-node-week4.onrender.com",BASE_URL:"/2024-node-week4_frontend/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const d=w.useLoading({}),{VITE_APP_URL:m}=h,$=P("userCommentsStore",{state:()=>({}),actions:{async createComment(t,e){const a=d.show(),s=`${m}/posts/${t}/comment`;try{const o=await i.post(s,{comment:e});c(o.data.message)}catch(o){r(o.response.data.message)}finally{a.hide()}},async deleteComment(t){const e=d.show(),a=`${m}/posts/${t}/uncomment`;try{const s=await i.delete(a);c(s.data.message)}catch(s){r(s.response.data.message)}finally{e.hide()}}}});var k={VITE_APP_URL:"https://two024-node-week4.onrender.com",BASE_URL:"/2024-node-week4_frontend/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const u=w.useLoading({}),{VITE_APP_URL:f}=k,E=P("userLikesStore",{state:()=>({}),actions:{async handleLikePost(t,e,a,s){const o=_();await o.getPosts();const l=await o.getAllPosts.find(n=>n._id===e);if(t==="metawall")try{this.isLiked(l,a)?await this.unlikePost(e):await this.likePost(e),await o.getPosts()}catch(n){r(n.response)}if(t==="userwall")try{this.isLiked(l,a)?await this.unlikePost(e):await this.likePost(e),await o.getUserPosts(s)}catch(n){r(n.response)}},isLiked(t,e){return!t||!Array.isArray(t.likes)?!1:t.likes.some(a=>a.user._id===e)},async likePost(t){const e=u.show(),a=`${f}/posts/${t}/like`;try{const s=await i.post(a);c(s.data.message)}catch(s){r(s.response.data.message)}finally{e.hide()}},async unlikePost(t){const e=u.show(),a=`${f}/posts/${t}/unlike`;try{const s=await i.delete(a);c(s.data.message)}catch(s){r(s.response.data.message)}finally{e.hide()}}}});export{E as a,$ as u};
