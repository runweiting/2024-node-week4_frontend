import{_ as y,e as _,m as h,r as k,o as i,c as l,a as e,f as m,v as w,g,h as c,F as b,i as u,j as C,w as P,t as d,n as S,k as L}from"./index-Do_aAaLG.js";import{p as f}from"./postsStore-AFCOf5SF.js";import{u as v}from"./userUsersStore-64V5Wi2f.js";import{u as j,a as T}from"./userLikesStore-HyzYBzM8.js";import{f as A}from"./formatCreatedAt-CTMo6T3e.js";import"./swalToasts-1gCIqy4y.js";const D={data(){return{timeSort:"",keyword:"",comment:""}},mounted(){this.getPosts(),this.getProfile()},computed:{..._(f,["postsList"]),..._(v,["profile"])},methods:{...h(f,["getPosts"]),...h(v,["getProfile"]),...h(j,["createComment","deleteComment"]),...h(T,["handleLikePost","isLiked","likePost","unlikePost"]),handleSearchPosts(s){this.getPosts("asc",s)},handleCreateComment(s,o){this.createComment(s,o),this.comment="",this.resetTextareaHeight(),this.getPosts()},handleDeleteComment(s){this.deleteComment(s).then(()=>this.getPosts())},adjustTextareaHeight(s){const o=s.target;o&&(o.style.height=`${o.scrollHeight}px`)},resetTextareaHeight(){const s=this.$refs.commentTextarea;s&&(s[0].style.height="1rem")},formatCreatedAt:A}},H={class:"col-8"},V={class:"row mb-4"},U={class:"col-4"},B=e("option",{value:"",selected:""},"請選擇順序",-1),M=e("option",{value:"asc"},"從新到舊",-1),N=e("option",{value:"desc"},"從舊到新",-1),z=[B,M,N],F={class:"col-8"},I={class:"input-group"},R=e("i",{class:"bi bi-search text-white fs-4"},null,-1),E=[R],q={key:0,class:"row"},G=L('<div class="col"><div class="bg-white rounded border border-2 border-black" style="border-bottom:4px solid black !important;"><div class="d-flex align-items-center gap-2 border-bottom border-2 border-black p-4 w-100" style="height:52px;"><div class="rounded border border-black border-1 bg-danger" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-warning" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-success" style="width:10px;height:10px;"></div></div><div class="text-center py-8" style="height:80px;"><p class="text-gray">目前尚無動態，新增一則貼文吧！</p></div></div></div>',1),J=[G],K={key:1,class:"row gy-6"},O={class:"bg-white rounded border border-2 border-black p-6",style:{"border-bottom":"4px solid black !important"}},Q={class:"rounded-circle overflow-hidden",style:{width:"45px",height:"45px"}},W=["src","alt"],X={class:"d-flex flex-column justify-content-between text-start"},Y={class:"noto-sans-tc text-primary fw-bold"},Z={class:"baloo-da-2 text-gray"},$={class:"noto-sans-tc mb-4"},ee=["src","alt"],te={class:"d-flex gap-2 mb-5"},se={class:"d-flex align-items-center mb-5"},oe={key:0,class:"d-flex align-items-center gap-2"},re=e("div",{class:"rounded-circle overflow-hidden bg-primary position-relative",style:{width:"24px",height:"24px"}},[e("i",{class:"bi bi-hand-thumbs-up-fill text-white position-absolute top-50 start-50 translate-middle"})],-1),ie={class:"noto-sans-tc"},le={class:"ms-auto"},de={class:"d-flex align-items-center gap-2"},ae=["onClick"],ne={class:"baloo-da-2 fw-bold"},ce={class:"d-flex align-items-start gap-2 mb-4 w-100"},he={key:0,class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},me=["src","alt"],be=["onClick"],ue={class:"row px-4 gy-4"},pe={class:"d-flex align-items-center gap-2 mb-1"},_e={class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},ge=["src","alt"],fe={class:"d-flex flex-column justify-content-between text-start"},ve={class:"noto-sans-tc text-primary fw-bold"},xe={class:"baloo-da-2 text-gray"},ye={class:"d-flex justify-content-between align-items-center"},ke={class:"ms-12 mb-1",style:{width:"85%"}},we={class:"mt-auto"},Ce=["onClick"],Pe=e("i",{class:"bi bi-trash3 text-primary"},null,-1),Se=[Pe];function Le(s,o,je,Te,a,n){const x=k("RouterLink");return i(),l("div",H,[e("div",V,[e("div",U,[m(e("select",{onInput:o[0]||(o[0]=t=>s.getPosts(a.timeSort)),"onUpdate:modelValue":o[1]||(o[1]=t=>a.timeSort=t),class:"form-select rounded-0 border-2 border-black py-3 ps-4 pe-10","aria-label":"posts-select"},z,544),[[w,a.timeSort]])]),e("div",F,[e("div",I,[m(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>a.keyword=t),type:"text",class:"form-control rounded-0 border-2 border-black py-3 px-4",placeholder:"搜尋貼文","aria-label":"搜尋貼文","aria-describedby":"搜尋貼文"},null,512),[[g,a.keyword]]),e("button",{onClick:o[3]||(o[3]=t=>n.handleSearchPosts(a.keyword)),class:"btn btn-primary rounded-0 px-4",type:"button"},E)])])]),s.postsList.length?c("",!0):(i(),l("div",q,J)),s.postsList.length?(i(),l("div",K,[(i(!0),l(b,null,u(s.postsList,t=>(i(),l("div",{key:t.id,class:"col-12"},[e("div",O,[t.user?(i(),C(x,{key:0,to:{name:"user",params:{id:t.user._id}},class:"d-flex gap-2 mb-4 text-black text-decoration-none"},{default:P(()=>[e("div",Q,[e("img",{src:t.user.photo,alt:`user-photo-${t.user.name}`,class:"object-fit-cover img-fluid",style:{height:"45px"}},null,8,W)]),e("div",X,[e("span",Y,d(t.user.name),1),e("small",Z,d(n.formatCreatedAt(t.createdAt).formattedDateAndTime),1)])]),_:2},1032,["to"])):c("",!0),e("p",$,d(t.content),1),e("img",{src:t.image,alt:`photo-${t.image}`,class:"object-fit-cover img-fluid rounded border border-2 border-black mb-2"},null,8,ee),e("div",te,[(i(!0),l(b,null,u(t.tags,(r,p)=>(i(),l("span",{key:p,class:"badge rounded-pill bg-secondary text-black noto-sans-tc border border-2 border-black"},d(r),1))),128))]),e("div",se,[t.likes.length?(i(),l("div",oe,[re,e("small",ie,d(t.likes[0].user.name)+" 和其他 "+d(t.likes.length-1)+"人按讚",1)])):c("",!0),e("div",le,[e("div",de,[e("button",{onClick:r=>s.handleLikePost("metawall",t._id,s.profile._id,null),type:"button",class:"btn p-0"},[e("i",{class:S([s.isLiked(t,s.profile._id)?"bi bi-hand-thumbs-up-fill":"bi bi-hand-thumbs-up","fs-5 text-primary"])},null,2)],8,ae),e("span",ne,d(t.likes.length),1)])])]),e("div",ce,[s.profile._id?(i(),l("div",he,[e("img",{src:s.profile.photo,alt:`user-photo-${s.profile.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,me)])):c("",!0),m(e("textarea",{ref_for:!0,ref:"commentTextarea","onUpdate:modelValue":o[4]||(o[4]=r=>a.comment=r),class:"form-control rounded border-2 border-black py-2 px-4",placeholder:"留言...","aria-label":"留言","aria-describedby":"留言",rows:"1",style:{flex:"3",overflow:"hidden",resize:"none"},onInput:o[5]||(o[5]=(...r)=>n.adjustTextareaHeight&&n.adjustTextareaHeight(...r))},null,544),[[g,a.comment]]),e("button",{onClick:r=>n.handleCreateComment(t._id,a.comment),class:"btn btn-warning rounded border-2 border-primary px-4 py-2",type:"button",style:{flex:"1"}},"留言",8,be)]),e("div",ue,[(i(!0),l(b,null,u(t.comments,r=>(i(),l("div",{key:r._id,class:"col-12 rounded p-4",style:{"background-color":"rgb(239 236 231 / 50%)"}},[e("div",pe,[e("div",_e,[e("img",{src:r.user.photo,alt:`user-photo-${r.user.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,ge)]),e("div",fe,[e("span",ve,d(r.user.name),1),e("small",xe,d(n.formatCreatedAt(r.createdAt).formattedDateAndTime),1)])]),e("div",ye,[e("p",ke,d(r.comment),1),e("div",we,[e("button",{onClick:p=>n.handleDeleteComment(r._id),type:"button",class:"btn p-0"},Se,8,Ce)])])]))),128))])])]))),128))])):c("",!0)])}const Me=y(D,[["render",Le]]);export{Me as default};
