import{p as h,q as f,s as c,u as w}from"./index-1rihly0f.js";import{a as i,s as d}from"./showSuccessToast-ENfQb9My.js";var g={VITE_APP_URL:"https://two024-node-week4.onrender.com",BASE_URL:"/2024-node-week4_frontend/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const l=h.useLoading({}),{VITE_LOCALHOST:p}=g,_=f("userUsersStore",{state:()=>({profile:{}}),actions:{async signUp(a,t,s,o){const e=l.show(),n=`${p}/users/sign_up`;try{const r=await c.post(n,{name:a,email:t,password:s,confirmPassword:o}),{expired:u,token:m}=r.data;document.cookie=`myToken=${m}; expires=${new Date(u)}`,i(r.data.message)}catch(r){d(r.response.data.message)}finally{e.hide()}},async signIn(a,t){const s=l.show(),o=`${p}/users/sign_in`;if(w())i("您已經登入！");else try{const e=await c.post(o,{email:a,password:t}),{expired:n,token:r}=e.data;document.cookie=`myToken=${r}; expires=${new Date(n)}`,c.defaults.headers.common.Authorization=`Bearer ${r}`,i(e.data.message)}catch(e){d(e.response.data.message)}finally{s.hide()}},async getProfile(){const a=l.show(),t=`${p}/users/profile`;try{const s=await c.get(t),{data:o}=s.data;this.profile=o,i(s.data.message)}catch(s){d(s.response.data.message)}finally{a.hide()}},async updateProfile(a,t){const s=l.show(),o=`${p}/users/profile`;try{const e=await c.patch(o,{name:a,gender:t}),{data:n}=e.data;this.profile=n,i(e.data.message)}catch(e){d(e.response.data.message)}finally{s.hide()}},async updatePassword(a,t){const s=l.show(),o=`${p}/users/update_password`;try{const e=await c.patch(o,{password:a,confirmPassword:t}),{expired:n,token:r}=e.data;document.cookie=`myToken=${r}; expires=${new Date(n)}`,c.defaults.headers.common.Authorization=null;const u=`${e.data.message}，請重新登入！`;i(u)}catch(e){d(e.response.data.message)}finally{s.hide()}}}});export{_ as u};
