import{_ as x,e as b,m as h,r as U,o as r,c as l,a as e,t as a,h as c,f as u,v as C,g as w,F as m,j as p,k as P,w as S,n as j,l as I}from"./index-KKaFkjlm.js";import{p as y}from"./postsStore-c89jXvJc.js";import{u as v}from"./userUsersStore-Ldjne8Fa.js";import{u as L,a as F}from"./userLikesStore-JWf307y5.js";import{u as g}from"./userFollowersStore-QJnYT0mH.js";import{w as T}from"./swalToasts-VAfFj8IW.js";import{f as A}from"./formatCreatedAt-CTMo6T3e.js";const D={data(){return{timeSort:"",keyword:"",comment:"",targetUserId:""}},created(){this.targetUserId=this.$route.params.id},async mounted(){await this.getUserPosts(this.targetUserId),await this.getProfile(),await this.getFollowingList(),this.isFollowed(this.followingList,this.targetUserId)},computed:{...b(y,["userPosts"]),...b(v,["profile"]),...b(g,["followingList"]),...b(g,["toggleFollow"])},methods:{...h(y,["getUserPosts"]),...h(v,["getProfile"]),...h(L,["createComment","deleteComment"]),...h(F,["handleLikePost","isLiked","likePost","unlikePost"]),...h(g,["getFollowingList","isFollowed","followUser","unfollowUser"]),async handleFollowUser(t){await this.followUser(t),this.$router.push({name:"following-list"})},async handleUnfollowUser(t){await this.unfollowUser(t),this.$router.push({name:"following-list"})},handleSearchPosts(t){this.getUserPosts(this.targetUserId,"asc",t)},handleCreateComment(t,o){this.createComment(t,o),this.comment="",this.resetTextareaHeight(),this.getUserPosts(this.targetUserId)},handleDeleteComment(t,o,_){o!==_?T("無法刪除他人留言"):this.deleteComment(t).then(()=>this.getUserPosts(this.targetUserId))},adjustTextareaHeight(t){const o=t.target;o&&(o.style.height=`${o.scrollHeight}px`)},resetTextareaHeight(){const t=this.$refs.commentTextarea;t&&(t[0].style.height="1rem")},formatCreatedAt:A}},H={class:"col-8"},V={key:0,class:"row"},B=e("div",{class:"col shadow-new-post"},[e("div",{class:"bg-white border border-2 border-black azeret-mono fs-5 fw-bold py-5 mb-6 w-100 text-center"}," 我的個人牆 ")],-1),z=[B],N={key:1,class:"row mb-6"},M={class:"col shadow-user-wall"},R={key:0,class:"d-flex bg-white rounded border border-2 border-black"},E={class:"overflow-hidden rounded-start",style:{width:"80px",height:"80px"}},W=["src","alt"],q={class:"d-flex justify-content-between p-4 w-100"},G={class:"d-flex flex-column"},J={class:"noto-sans-tc text-primary fw-bold"},K={class:"baloo-da-2"},O={class:"row mb-4"},Q={class:"col-4"},X=e("option",{value:"",selected:""},"請選擇順序",-1),Y=e("option",{value:"asc"},"從新到舊",-1),Z=e("option",{value:"desc"},"從舊到新",-1),$=[X,Y,Z],ee={class:"col-8"},te={class:"input-group"},se=e("i",{class:"bi bi-search text-white fs-4"},null,-1),oe=[se],re={key:2,class:"row"},le=I('<div class="col"><div class="bg-white rounded border border-2 border-black" style="border-bottom:4px solid black !important;"><div class="d-flex align-items-center gap-2 border-bottom border-2 border-black p-4 w-100" style="height:52px;"><div class="rounded border border-black border-1 bg-danger" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-warning" style="width:10px;height:10px;"></div><div class="rounded border border-black border-1 bg-success" style="width:10px;height:10px;"></div></div><div class="text-center py-8" style="height:80px;"><p class="text-gray">目前尚無動態，新增一則貼文吧！</p></div></div></div>',1),ie=[le],de={key:3,class:"row gy-6"},ae={class:"bg-white rounded border border-2 border-black p-6",style:{"border-bottom":"4px solid black !important"}},ne={class:"rounded-circle overflow-hidden",style:{width:"45px",height:"45px"}},ce=["src","alt"],he={class:"d-flex flex-column justify-content-between text-start"},be={class:"noto-sans-tc text-primary fw-bold"},ue={class:"baloo-da-2 text-gray"},me={class:"noto-sans-tc mb-4"},pe=["src","alt"],ge={class:"d-flex gap-2 mb-5"},_e={class:"d-flex align-items-center mb-5"},fe={key:0,class:"d-flex align-items-center gap-2"},we=e("div",{class:"rounded-circle overflow-hidden bg-primary position-relative",style:{width:"24px",height:"24px"}},[e("i",{class:"bi bi-hand-thumbs-up-fill text-white position-absolute top-50 start-50 translate-middle"})],-1),ye={key:0,class:"noto-sans-tc"},ve={class:"ms-auto"},ke={class:"d-flex align-items-center gap-2"},xe=["onClick"],Ue={class:"baloo-da-2 fw-bold"},Ce={class:"d-flex align-items-start gap-2 mb-4 w-100"},Pe={key:0,class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},Se=["src","alt"],je=["onClick"],Ie={class:"row px-4 gy-4"},Le={class:"d-flex align-items-center gap-2 mb-1"},Fe={class:"rounded-circle overflow-hidden",style:{width:"40px",height:"40px"}},Te=["src","alt"],Ae={class:"d-flex flex-column justify-content-between text-start"},De={class:"noto-sans-tc text-primary fw-bold"},He={class:"baloo-da-2 text-gray"},Ve={class:"d-flex justify-content-between align-items-center"},Be={class:"ms-12 mb-1",style:{width:"85%"}},ze={class:"mt-auto"},Ne=["onClick"],Me=e("i",{class:"bi bi-trash3 text-primary"},null,-1),Re=[Me];function Ee(t,o,_,We,d,n){const k=U("RouterLink");return r(),l("div",H,[d.targetUserId===t.profile._id?(r(),l("div",V,z)):(r(),l("div",N,[e("div",M,[t.userPosts.targetUser?(r(),l("div",R,[e("div",E,[e("img",{src:t.userPosts.targetUser.photo,alt:`user-photo-${t.userPosts.targetUser.name}`,class:"object-fit-cover img-fluid",style:{height:"80px"}},null,8,W)]),e("div",q,[e("div",G,[e("span",J,a(t.userPosts.targetUser.name),1),e("span",K,a(t.userPosts.targetUser.followers.length)+" 人追蹤",1)]),t.toggleFollow?(r(),l("button",{key:0,onClick:o[0]||(o[0]=s=>n.handleFollowUser(t.userPosts.targetUser._id)),type:"button",class:"btn btn-warning rounded border border-2 border-black w-25 noto-sans-tc fw-bold",style:{"border-bottom":"4px solid black !important"}},"追蹤")):(r(),l("button",{key:1,onClick:o[1]||(o[1]=s=>n.handleUnfollowUser(t.userPosts.targetUser._id)),type:"button",class:"btn btn-light rounded border border-2 border-black w-25 noto-sans-tc fw-bold",style:{"border-bottom":"4px solid black !important"}},"取消追蹤"))])])):c("",!0)])])),e("div",O,[e("div",Q,[u(e("select",{onInput:o[2]||(o[2]=s=>t.getUserPosts(d.targetUserId,d.timeSort)),"onUpdate:modelValue":o[3]||(o[3]=s=>d.timeSort=s),class:"form-select rounded-0 border-2 border-black py-3 ps-4 pe-10","aria-label":"posts-select"},$,544),[[C,d.timeSort]])]),e("div",ee,[e("div",te,[u(e("input",{"onUpdate:modelValue":o[4]||(o[4]=s=>d.keyword=s),type:"search",class:"form-control rounded-0 border-2 border-black py-3 px-4",placeholder:"搜尋貼文","aria-label":"搜尋貼文","aria-describedby":"搜尋貼文"},null,512),[[w,d.keyword]]),e("button",{onClick:o[5]||(o[5]=s=>n.handleSearchPosts(d.keyword)),class:"btn btn-primary rounded-0 px-4",type:"button"},oe)])])]),t.userPosts.posts?c("",!0):(r(),l("div",re,ie)),t.userPosts.posts?(r(),l("div",de,[(r(!0),l(m,null,p(t.userPosts.posts,s=>(r(),l("div",{key:s.id,class:"col-12"},[e("div",ae,[s.user._id?(r(),P(k,{key:0,to:{name:"user",params:{id:s.user._id}},class:"d-flex gap-2 mb-4 text-black text-decoration-none"},{default:S(()=>[e("div",ne,[e("img",{src:s.user.photo,alt:`user-photo-${s.user.name}`,class:"object-fit-cover img-fluid",style:{height:"45px"}},null,8,ce)]),e("div",he,[e("span",be,a(s.user.name),1),e("small",ue,a(n.formatCreatedAt(s.createdAt).formattedDateAndTime),1)])]),_:2},1032,["to"])):c("",!0),e("p",me,a(s.content),1),e("img",{src:s.image,alt:`photo-${s.image}`,class:"object-fit-cover img-fluid rounded border border-2 border-black mb-2"},null,8,pe),e("div",ge,[(r(!0),l(m,null,p(s.tags,(i,f)=>(r(),l("span",{key:f,class:"badge rounded-pill bg-secondary text-black noto-sans-tc border border-2 border-black"},a(i),1))),128))]),e("div",_e,[s.likes.length?(r(),l("div",fe,[we,s.likes[0]?(r(),l("small",ye,a(s.likes[0].user.name)+" 和其他 "+a(s.likes.length-1)+"人按讚",1)):c("",!0)])):c("",!0),e("div",ve,[e("div",ke,[e("button",{onClick:i=>t.handleLikePost("userwall",s._id,t.profile._id,d.targetUserId),type:"button",class:"btn p-0"},[e("i",{class:j([t.isLiked(s,t.profile._id)?"bi bi-hand-thumbs-up-fill":"bi bi-hand-thumbs-up","fs-5 text-primary"])},null,2)],8,xe),e("span",Ue,a(s.likes.length),1)])])]),e("div",Ce,[t.profile._id?(r(),l("div",Pe,[e("img",{src:t.profile.photo,alt:`user-photo-${t.profile.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,Se)])):c("",!0),u(e("textarea",{ref_for:!0,ref:"commentTextarea","onUpdate:modelValue":o[6]||(o[6]=i=>d.comment=i),class:"form-control rounded border-2 border-black py-2 px-4",placeholder:"留言...","aria-label":"留言","aria-describedby":"留言",rows:"1",style:{flex:"3",overflow:"hidden",resize:"none"},onInput:o[7]||(o[7]=(...i)=>n.adjustTextareaHeight&&n.adjustTextareaHeight(...i))},null,544),[[w,d.comment]]),e("button",{onClick:i=>n.handleCreateComment(s._id,d.comment),class:"btn btn-warning rounded border-2 border-primary px-4 py-2",type:"button",style:{flex:"1"}},"留言",8,je)]),e("div",Ie,[(r(!0),l(m,null,p(s.comments,i=>(r(),l("div",{key:i._id,class:"col-12 rounded p-4",style:{"background-color":"rgb(239 236 231 / 50%)"}},[e("div",Le,[e("div",Fe,[e("img",{src:i.user.photo,alt:`user-photo-${i.user.name}`,class:"object-fit-cover img-fluid",style:{height:"40px"}},null,8,Te)]),e("div",Ae,[e("span",De,a(i.user.name),1),e("small",He,a(n.formatCreatedAt(i.createdAt).formattedDateAndTime),1)])]),e("div",Ve,[e("p",Be,a(i.comment),1),e("div",ze,[e("button",{onClick:f=>n.handleDeleteComment(i._id,i.user._id,t.profile._id),type:"button",class:"btn p-0"},Re,8,Ne)])])]))),128))])])]))),128))])):c("",!0)])}const Ye=x(D,[["render",Ee]]);export{Ye as default};
